<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Docs-as-System - ×ª×‘× ×™×•×ª ×‘×¢×‘×¨×™×ª</title>
  <link rel="icon" href="../../logo.svg">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:"Assistant",-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:linear-gradient(135deg,#2563eb 0%,#0ea5e9 100%);
      min-height:100vh;
      padding:40px 20px;
      color:#1a1a1a;
    }
    .container{
      max-width:900px;
      margin:0 auto;
      background:#fff;
      border-radius:16px;
      padding:40px;
      box-shadow:0 20px 60px rgba(0,0,0,0.3);
    }
    header{
      text-align:center;
      margin-bottom:40px;
      padding-bottom:24px;
      border-bottom:2px solid #e5e7eb;
    }
    h1{
      font-size:clamp(28px,5vw,42px);
      font-weight:700;
      margin-bottom:12px;
      color:#2563eb;
    }
    .subtitle{
      font-size:18px;
      color:#6b7280;
      margin-bottom:20px;
    }
    .nav{
      margin-top:16px;
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:center;
      flex-wrap:wrap;
    }
    .nav a{
      display:inline-block;
      padding:8px 16px;
      background:#f3f4f6;
      color:#2563eb;
      text-decoration:none;
      border-radius:6px;
      font-size:14px;
      transition:all 0.2s;
    }
    .nav a:hover{
      background:#2563eb;
      color:#fff;
    }

    .top-menu{
      margin-top:24px;
      display:flex;
      gap:12px;
      justify-content:center;
      flex-wrap:wrap;
    }
    .top-menu button{
      padding:8px 14px;
      border-radius:6px;
      border:1px solid #e5e7eb;
      background:#fff;
      cursor:pointer;
      font-family:inherit;
      font-size:14px;
      transition:all 0.2s;
    }
    .top-menu button:hover{
      background:#2563eb;
      color:#fff;
      border-color:#2563eb;
    }

    .download-all-btn{
      background:linear-gradient(135deg,#10b981 0%,#059669 100%);
      color:#fff;
      padding:10px 20px;
      border-radius:8px;
      font-weight:600;
      display:inline-flex;
      align-items:center;
      gap:8px;
      box-shadow:0 4px 12px rgba(16,185,129,0.3);
      border:none;
      cursor:pointer;
      transition:all 0.3s;
    }
    .download-all-btn:hover{
      transform:translateY(-2px);
      box-shadow:0 6px 16px rgba(16,185,129,0.4);
    }
    .download-all-btn svg{
      width:20px;
      height:20px;
      fill:currentColor;
    }

    .templates{
      display:grid;
      grid-template-columns:repeat(2,1fr);
      gap:16px;
      margin-top:24px;
    }
    @media (max-width:768px){
      .templates{
        grid-template-columns:1fr;
      }
    }
    .template-item{
      display:flex;
      align-items:center;
      padding:16px 20px;
      background:#f9fafb;
      border-radius:8px;
      border:2px solid #e5e7eb;
      transition:all 0.2s;
      gap:12px;
    }
    .template-item:hover{
      border-color:#2563eb;
      background:#eff6ff;
      transform:translateX(4px);
    }
    .template-item a{
      flex:1;
      color:#1a1a1a;
      text-decoration:none;
      font-weight:500;
      font-size:16px;
    }
    .icon{
      margin-left:12px;
      font-size:20px;
    }
    .download-icon{
      background:#fff;
      color:#60a5fa;
      width:36px;
      height:36px;
      display:flex;
      align-items:center;
      justify-content:center;
      border-radius:8px;
      text-decoration:none;
      transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      font-size:16px;
      box-shadow:0 2px 8px rgba(37,99,235,0.15);
      border:2px solid #e5e7eb;
      position:relative;
      overflow:hidden;
    }
    .download-icon::before{
      content:'';
      position:absolute;
      top:0;
      left:0;
      right:0;
      bottom:0;
      background:linear-gradient(135deg,#eff6ff 0%,#dbeafe 100%);
      opacity:0;
      transition:opacity 0.3s;
    }
    .download-icon:hover::before{
      opacity:1;
    }
    .download-icon:hover{
      transform:translateY(-2px);
      box-shadow:0 4px 12px rgba(37,99,235,0.25);
      border-color:#2563eb;
    }
    .download-icon:active{
      transform:translateY(0);
    }
    .download-icon svg{
      position:relative;
      z-index:1;
      width:24px;
      height:24px;
      fill:#60a5fa !important;
    }

    @keyframes spin{
      to{transform:rotate(360deg);}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Docs-as-System</h1>
      <div class="subtitle">×ª×‘× ×™×•×ª ×‘×¢×‘×¨×™×ª</div>
      <nav class="nav">
        <a href="../../index.he.html">×—×–×¨×” ×œ×¢××•×“ ×”×‘×™×ª â†</a>
        <a href="../en/">English</a>
      </nav>
      <nav class="top-menu">
        <button onclick="openReadme('agent')">×¡×•×›×Ÿ</button>
        <button onclick="openReadme('architecture')">××¨×›×™×˜×§×˜×•×¨×”</button>
        <button onclick="openReadme('automation')">××•×˜×•××¦×™×”</button>
        <button onclick="openReadme('logs')">×™×•×× ×™×</button>
        <button onclick="openReadme('planning')">×ª×›× ×•×Ÿ</button>
        <button onclick="openReadme('project')">×¤×¨×•×™×§×˜</button>
      </nav>
    </header>

    <div style="margin-top:48px;text-align:center;color:#888;font-size:18px;">
      ×‘×—×¨ ×§×˜×’×•×¨×™×” ××”×ª×¤×¨×™×˜ ×”×¢×œ×™×•×Ÿ ×œ×¦×¤×™×™×” ×‘×ª×‘× ×™×•×ª
    </div>
        <div id="folder-files" style="margin-top:48px;"></div>
    </div>
  </div>

  <!-- ×›×œ ×”×¡×§×¨×™×¤×˜×™× ×‘×¡×•×£ ×”×“×£ -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.6/dist/purify.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked@12.0.2/marked.min.js"></script>
  <script>
        // ×§×‘×¦×™× ×œ×›×œ ×ª×™×§×™×” (×¡×˜×˜×™, ××¤×©×¨ ×œ×”×—×œ×™×£ ×œ-fetch ×‘×¢×ª×™×“)
        const folderFiles = {
          agent: [
            {name:'AGENT_CONFIG_TEMPLATE.yaml',type:'yaml'},
            {name:'AGENT_OPERATIONAL_POLICY_TEMPLATE.md',type:'md'},
            {name:'HUMAN_OPERATIONAL_POLICY_TEMPLATE.md',type:'md'},
            {name:'README.md',type:'md'},
            {name:'SECURITY_CHECKLIST_TEMPLATE.md',type:'md'},
            {name:'VALIDATION_REPORT_TEMPLATE.md',type:'md'}
          ],
          architecture: [
            {name:'ADR_TEMPLATE.md',type:'md'},
            {name:'ARCHITECTURE_BLUEPRINT_TEMPLATE.md',type:'md'},
            {name:'README.md',type:'md'}
          ],
          automation: [
            {name:'GUARDRAILS_TEMPLATE.md',type:'md'},
            {name:'PROMPTS_LIBRARY_TEMPLATE.md',type:'md'},
            {name:'README.md',type:'md'},
            {name:'VALIDATION_PIPELINE_TEMPLATE.md',type:'md'},
            {name:'WORKFLOWS_GUIDE_TEMPLATE.md',type:'md'}
          ],
          logs: [
            {name:'IMPLEMENTATION_LOG_BY_CYCLE_TEMPLATE.md',type:'md'},
            {name:'IMPLEMENTATION_LOG_SUMMARY_TEMPLATE.en.md',type:'md'},
            {name:'IMPLEMENTATION_LOG_SUMMARY_TEMPLATE.he.md',type:'md'},
            {name:'IMPLEMENTATION_LOG_TEMPLATE.md',type:'md'},
            {name:'README.md',type:'md'}
          ],
          planning: [
            {name:'BUSINESS_REQUIREMENTS_TEMPLATE.md',type:'md'},
            {name:'PLAN_TEMPLATE.md',type:'md'},
            {name:'PROJECT_SPEC_TEMPLATE.md',type:'md'},
            {name:'README.md',type:'md'}
          ],
          project: [
            {name:'COMPLIANCE_AND_GOVERNANCE_TEMPLATE.md',type:'md'},
            {name:'PROJECT_OVERVIEW_TEMPLATE.md',type:'md'},
            {name:'README.md',type:'md'},
            {name:'README_TEMPLATE.md',type:'md'}
          ]
        };

        // ×”×¦×’×ª ×¨×©×™××ª ×§×‘×¦×™× ×‘×ª×™×§×™×”
        window.showFolderFiles = function(folder) {
          const files = folderFiles[folder] || [];
          const container = document.getElementById('folder-files');
          if (!container) return;
          if (!files.length) {
            container.innerHTML = '<div style="color:#888;font-size:18px;">××™×Ÿ ×§×‘×¦×™× ×‘×ª×™×§×™×” ×–×•</div>';
            return;
          }
          container.innerHTML = `<h2 style='color:#2563eb;margin-bottom:18px;'>${folder} - ×§×‘×¦×™×</h2>` +
            files.map(file => `
              <div class='template-item' style='margin-bottom:8px;'>
                <span class='icon'>${file.type==='md'?'ğŸ“„':'ğŸ› ï¸'}</span>
                <span style='flex:1;font-size:16px;'>${file.name}</span>
                <button onclick="showFileContent('${folder}','${file.name}')" style='margin-left:8px;padding:6px 14px;background:#eff6ff;color:#2563eb;border-radius:6px;border:none;cursor:pointer;'>×”×¦×’</button>
              </div>
            `).join('');
        }

        // modal ×œ×”×¦×’×ª ×ª×•×›×Ÿ ×§×•×‘×¥
        function createModal(content) {
          const modal = document.createElement('div');
          modal.style.position = 'fixed';
          modal.style.top = '0';
          modal.style.left = '0';
          modal.style.width = '100vw';
          modal.style.height = '100vh';
          modal.style.background = 'rgba(0,0,0,0.4)';
          modal.style.zIndex = '9999';
          modal.style.display = 'flex';
          modal.style.alignItems = 'center';
          modal.style.justifyContent = 'center';
          modal.innerHTML = `
            <div style='background:#f9fafb;max-width:820px;width:96vw;max-height:86vh;overflow:auto;border-radius:18px;padding:44px 38px;box-shadow:0 12px 40px rgba(0,0,0,0.18);position:relative;font-family:"Assistant",sans-serif;'>
              <button onclick='this.parentElement.parentElement.remove()' style='position:absolute;top:22px;left:22px;background:#2563eb;color:#fff;border:none;border-radius:7px;padding:8px 18px;cursor:pointer;font-size:17px;font-weight:600;'>âœ– ×¡×’×•×¨</button>
              <div id='modal-content' style='line-height:2.1;font-size:18px;color:#222;word-break:break-word;'></div>
            </div>
          `;
          document.body.appendChild(modal);
        }

        window.showFileContent = function(folder, file) {
          createModal('<div style="color:#888;font-size:20px;padding:24px 0;">×˜×•×¢×Ÿ ×ª×•×›×Ÿ...</div>');
          fetch(`${folder}/${file}`)
            .then(r=>r.text())
            .then(t=>{
              let html;
              if (file.endsWith('.md')) {
                html = DOMPurify.sanitize(marked.parse(t,{mangle:false,headerIds:true}));
                html = `<div style='line-height:2.1;font-size:18px;color:#222;word-break:break-word;'>${html}</div>`;
              } else if (file.endsWith('.yaml') || file.endsWith('.yml')) {
                html = t.split('\n').map(line => {
                  if (/^\s*#/.test(line)) {
                    // ×”×¢×¨×” ×‘×¢×‘×¨×™×ª
                    return `<div style='direction:rtl;text-align:right;font-family:"Assistant",sans-serif;color:#2563eb;background:#eef2ff;padding:6px 18px 6px 8px;border-radius:7px;margin-bottom:2px;font-size:17px;'>${DOMPurify.sanitize(line)}</div>`;
                  } else if (/\S/.test(line)) {
                    // ×§×•×“ ×‘×× ×’×œ×™×ª
                    return `<div style='direction:ltr;text-align:left;font-family:monospace;background:#f3f4f6;padding:6px 18px;border-radius:7px;margin-bottom:2px;font-size:16px;color:#222;'>${DOMPurify.sanitize(line)}</div>`;
                  } else {
                    // ×©×•×¨×” ×¨×™×§×”
                    return `<div style='height:8px;'></div>`;
                  }
                }).join('');
              } else {
                html = `<pre style='background:#f3f4f6;padding:22px 18px;border-radius:10px;overflow:auto;font-size:16px;line-height:2.1;color:#222;'>${DOMPurify.sanitize(t)}</pre>`;
              }
              document.getElementById('modal-content').innerHTML = html;
            })
            .catch(e=>{
              document.getElementById('modal-content').innerHTML = `<div style='color:#e11d48;font-size:18px;padding:24px 0;'>×©×’×™××” ×‘×˜×¢×™× ×ª ×§×•×‘×¥: ${e.message}</div>`;
            });
        }

        // ×¢×“×›×•×Ÿ ×›×¤×ª×•×¨×™ ×”×ª×¤×¨×™×˜ ×”×¢×œ×™×•×Ÿ
        document.querySelectorAll('.top-menu button').forEach(btn => {
          btn.onclick = function() {
            window.showFolderFiles(this.getAttribute('onclick').replace(/openReadme\('(.*)'\)/,'$1'));
          }
        });
    async function downloadAllTemplates() {
      const btn = document.querySelector('.download-all-btn');
      if (!btn) return;
      const originalText = btn.innerHTML;
      btn.innerHTML =
        '<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="width:20px;height:20px;fill:currentColor;animation:spin 1s linear infinite"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none" opacity="0.25"/><path d="M12 2a10 10 0 0 1 10 10" stroke="currentColor" stroke-width="4" fill="none"/></svg> ××•×¨×™×“...';
      btn.disabled = true;
      // ×›××Ÿ ××¤×©×¨ ×œ×××© ×‘×¢×ª×™×“ ×”×•×¨×“×” ×©×œ ×›×œ ×”×§×‘×¦×™× ×‘×§×•×‘×¥ ZIP
      btn.disabled = false;
      btn.innerHTML = originalText;
    }

    // ×¤×•× ×§×¦×™×” ×’×œ×•×‘×œ×™×ª ×œ×¤×ª×™×—×ª README.md ×‘×ª×™×§×™×” ×—×“×©×”
    window.openReadme = function(folder) {
      const url = `${folder}/README.md`;
      const win = window.open('', '_blank');
      if (!win) {
        alert('×”×“×¤×“×¤×Ÿ ×—×¡× ×¤×ª×™×—×ª ×—×œ×•×Ÿ ×—×“×©');
        return;
      }
      win.document.write(
        `<!doctype html><html lang="he" dir="rtl">
        <head>
          <meta charset="utf-8">
          <meta name="viewport" content="width=device-width,initial-scale=1">
          <title>Docs-as-System - ${folder}</title>
          <link href='https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700&display=swap' rel='stylesheet'>
          <style>
            body{font-family:'Assistant',sans-serif;background:#f9fafb;padding:40px 0;color:#222;}
            .md{max-width:800px;margin:0 auto;background:#fff;border-radius:16px;padding:40px;box-shadow:0 8px 32px rgba(0,0,0,0.08);}
            .md h1,.md h2,.md h3{color:#2563eb;}
            .md code{background:#f3f4f6;padding:2px 6px;border-radius:4px;font-size:13px;}
            .md pre{background:#f3f4f6;padding:12px;border-radius:8px;overflow:auto;font-size:13px;}
            .md pre code{background:transparent;padding:0;}
            .md a{color:#2563eb;text-decoration:underline;}
          </style>
        </head>
        <body>
          <div class='md' id='md-content'>×˜×•×¢×Ÿ...</div>
          <script src='https://cdn.jsdelivr.net/npm/dompurify@3.1.6/dist/purify.min.js'><\/script>
          <script src='https://cdn.jsdelivr.net/npm/marked@12.0.2/marked.min.js'><\/script>
          <script>
            fetch('${url}')
              .then(r=>r.text())
              .then(t=>{
                document.getElementById('md-content').innerHTML =
                  DOMPurify.sanitize(marked.parse(t,{mangle:false,headerIds:true}))
              })
              .catch(e=>{
                document.getElementById('md-content').innerHTML =
                  '<div style="color:#e11d48">×©×’×™××” ×‘×˜×¢×™× ×ª README: '+e.message+'</div>'
              })
          <\/script>
        </body>
        </html>`
      );
      win.document.close();
    };
  </script>
</body>
</html>
